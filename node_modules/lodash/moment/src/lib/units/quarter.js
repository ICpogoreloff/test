import { addFormatToken } from 'lodash/moment/src/lib/format/format';
import { addUnitAlias } from 'lodash/moment/src/lib/units/aliases';
import { addUnitPriority } from 'lodash/moment/src/lib/units/priorities';
import { addRegexToken, match1 } from 'lodash/moment/src/lib/parse/regex';
import { addParseToken } from 'lodash/moment/src/lib/parse/token';
import { MONTH } from 'lodash/moment/src/lib/units/constants';
import toInt from 'lodash/moment/src/lib/utils/to-int';

// FORMATTING

addFormatToken('Q', 0, 'Qo', 'quarter');

// ALIASES

addUnitAlias('quarter', 'Q');

// PRIORITY

addUnitPriority('quarter', 7);

// PARSING

addRegexToken('Q', match1);
addParseToken('Q', function (input, array) {
    array[MONTH] = (toInt(input) - 1) * 3;
});

// MOMENTS

export function getSetQuarter(input) {
    return input == null
        ? Math.ceil((this.month() + 1) / 3)
        : this.month((input - 1) * 3 + (this.month() % 3));
}
